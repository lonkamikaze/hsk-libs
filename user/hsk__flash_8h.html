<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hsk-libs-user: hsk_flash/hsk_flash.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hsk-libs-user
   &#160;<span id="projectnumber">257</span>
   </div>
   <div id="projectbrief">High Speed Karlsruhe XC878 library collection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('hsk__flash_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hsk_flash.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>HSK Flash Facility headers.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;../hsk_isr/hsk_isr.isr&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for hsk_flash.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="hsk__flash_8h__incl.svg" width="160" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="hsk__flash_8h__dep__incl.svg" width="160" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="hsk__flash_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa6c4686de74233ed2950c20137c25948"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#aa6c4686de74233ed2950c20137c25948">XC878_16FF</a></td></tr>
<tr class="memdesc:aa6c4686de74233ed2950c20137c25948"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure that a flash memory layout is defined.  <a href="#aa6c4686de74233ed2950c20137c25948">More...</a><br /></td></tr>
<tr class="separator:aa6c4686de74233ed2950c20137c25948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71bde424c23bd9ae815a892d241b1e45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#a71bde424c23bd9ae815a892d241b1e45">FLASH_STRUCT_FACTORY</a>(members)</td></tr>
<tr class="memdesc:a71bde424c23bd9ae815a892d241b1e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to create a struct that can be used with the <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> function.  <a href="#a71bde424c23bd9ae815a892d241b1e45">More...</a><br /></td></tr>
<tr class="separator:a71bde424c23bd9ae815a892d241b1e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63192d688a712912c26c4c2dccc75a75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#a63192d688a712912c26c4c2dccc75a75">FLASH_PWR_FIRST</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a63192d688a712912c26c4c2dccc75a75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returned by <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> when the µC boots for the first time.  <a href="#a63192d688a712912c26c4c2dccc75a75">More...</a><br /></td></tr>
<tr class="separator:a63192d688a712912c26c4c2dccc75a75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a7f703f282c93c9080240c25368951"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#a75a7f703f282c93c9080240c25368951">FLASH_PWR_RESET</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a75a7f703f282c93c9080240c25368951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returned by <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> after booting from a reset without power loss.  <a href="#a75a7f703f282c93c9080240c25368951">More...</a><br /></td></tr>
<tr class="separator:a75a7f703f282c93c9080240c25368951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc1b86792d9ad20221462efa99fc5b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#a0cc1b86792d9ad20221462efa99fc5b1">FLASH_PWR_ON</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:a0cc1b86792d9ad20221462efa99fc5b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returned by <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> during power on, if valid data was recovered from the D-Flash.  <a href="#a0cc1b86792d9ad20221462efa99fc5b1">More...</a><br /></td></tr>
<tr class="separator:a0cc1b86792d9ad20221462efa99fc5b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acc2074fa68d4da24fb483fbd49438da9"><td class="memItemLeft" align="right" valign="top">ubyte&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9">hsk_flash_init</a> (void *const ptr, const uword size, const ubyte version)</td></tr>
<tr class="memdesc:acc2074fa68d4da24fb483fbd49438da9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recovers a struct from a previous session and sets everything up for storage of changes.  <a href="#acc2074fa68d4da24fb483fbd49438da9">More...</a><br /></td></tr>
<tr class="separator:acc2074fa68d4da24fb483fbd49438da9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36a01af82333ae82b381cd939fcd421f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hsk__flash_8h.html#a36a01af82333ae82b381cd939fcd421f">hsk_flash_write</a> (void)</td></tr>
<tr class="memdesc:a36a01af82333ae82b381cd939fcd421f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the current data to the D-Flash.  <a href="#a36a01af82333ae82b381cd939fcd421f">More...</a><br /></td></tr>
<tr class="separator:a36a01af82333ae82b381cd939fcd421f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>HSK Flash Facility headers. </p>
<p>This file contains function prototypes to menage information that survives a reset and allow storage within the D-Flash.</p>
<p>It provides the <a class="el" href="hsk__flash_8h.html#a71bde424c23bd9ae815a892d241b1e45">FLASH_STRUCT_FACTORY</a> to create a struct with data that can be stored with <a class="el" href="hsk__flash_8h.html#a36a01af82333ae82b381cd939fcd421f" title="Writes the current data to the D-Flash. ">hsk_flash_write()</a> and recovered with <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a>.</p>
<p>The D-Flash is used as a ring buffer, this distributes writes over the entire flash to gain the maximum achievable lifetime. The lifetime expectancy depends on your usage scenario and the size of the struct.</p>
<p>Refer to section 3.3 table 20 and table 21 of the <a href="../contrib/Microcontroller-XC87x-Data-Sheet-V15-infineon.pdf">XC87x data sheet</a> for D-Flash life times.</p>
<p>Complete coverage of the D-Flash counts as a single D-Flash cycle. Thus the formula for the expected number of write calls is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ writes = \lfloor 4096 / sizeof(struct) \rfloor * expectedcycles \]" src="form_1.png"/>
</p>
<ul>
<li><code>expectedcycles</code> <ul>
<li>The expected number of possible write cycles depending on the usage scenario in table 20</li>
</ul>
</li>
<li><code>sizeof(struct)</code> <ul>
<li>The number of bytes the struct covers</li>
</ul>
</li>
<li><code>floor()</code> <ul>
<li>Round down to the next smaller integer</li>
</ul>
</li>
</ul>
<p>E.g. to store 20 bytes of configuration data, the struct factory adds 2 bytes overhead to be able to check the consistency of written data, so <img class="formulaInl" alt="$ sizeof(struct) = 22 $" src="form_2.png"/>. Expecting that most of the µC use is within the first year, table 20 suggests that <img class="formulaInl" alt="$ expectedcycles = 100000 $" src="form_3.png"/>. In that case the expected number of possible <a class="el" href="hsk__flash_8h.html#a36a01af82333ae82b381cd939fcd421f" title="Writes the current data to the D-Flash. ">hsk_flash_write()</a> calls is 18.6 million.</p>
<dl class="section author"><dt>Author</dt><dd>kami</dd></dl>
<h1><a class="anchor" id="flash_byte_order"></a>
Byte Order</h1>
<p>C51 stores multiple byte variables in big endian order, whereas the DPTR register, several SFRs and SDCC use little endian.</p>
<p>If the data struct contains multibyte members such as int/uword or long/ulong, this can lead to data corruption, when switching compilers.</p>
<p>Both the checksum and identifier are single byte values and thus will still match after a compiler switch, causing multibyte values to be restored from the flash with the wrong byte order.</p>
<p>A byte order change can be detected with a byte order word in the struct. A BOW initialized with 0x1234 would read 0x3412 after a an order change.</p>
<p>The suggested solution is to only create struct members with byte wise access. E.g. a ulong member may be defined in the following way: </p><div class="fragment"><div class="line">ubyte ulongMember[<span class="keyword">sizeof</span>(ulong)];</div></div><!-- fragment --><p>The value can be set like this: </p><div class="fragment"><div class="line">myStruct.ulongMember[0] = ulongValue;</div><div class="line">myStruct.ulongMember[1] = ulongValue &gt;&gt; 8;</div><div class="line">myStruct.ulongMember[2] = ulongValue &gt;&gt; 16;</div><div class="line">myStruct.ulongMember[3] = ulongValue &gt;&gt; 24;</div></div><!-- fragment --><p>Reading works similarly: </p><div class="fragment"><div class="line">ulongValue  = (ubyte)myStruct.ulongMember[0];</div><div class="line">ulongValue |= (uword)myStruct.ulongMember[1] &lt;&lt; 8;</div><div class="line">ulongValue |= (ulong)myStruct.ulongMember[2] &lt;&lt; 16;</div><div class="line">ulongValue |= (ulong)myStruct.ulongMember[3] &lt;&lt; 24;</div></div><!-- fragment --><p>Another alternative is to use a single ubyte[] array and store/read all data with the <a class="el" href="hsk__can_8h.html#adf8bd1f3146a1dee87f7ba9164047f48" title="Sets a signal value in a data field. ">hsk_can_data_setSignal()</a>/<a class="el" href="hsk__can_8h.html#a7ada35c7635c86614d5852553bdcaf88">hsk_can_data_getSignal()</a> functions. Due to the bit addressing of CAN message data the maximum length of such an array would be 32 bytes (256bits).</p>
<p>An advantage would be that less memory is required, because data no longer needs to be byte aligned. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a63192d688a712912c26c4c2dccc75a75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63192d688a712912c26c4c2dccc75a75">&sect;&nbsp;</a></span>FLASH_PWR_FIRST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_PWR_FIRST&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returned by <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> when the µC boots for the first time. </p>
<p>This statements holds true <em>as far as can be told</em>. I.e. a first boot is diagnosed when all attempts to recover data have failed.</p>
<p>Two scenarios may cause this:</p><ul>
<li>No valid data has yet been written to the D-Flash</li>
<li>The latest flash data is corrupted, may happen in case of power down during write </li>
</ul>

</div>
</div>
<a id="a0cc1b86792d9ad20221462efa99fc5b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc1b86792d9ad20221462efa99fc5b1">&sect;&nbsp;</a></span>FLASH_PWR_ON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_PWR_ON&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returned by <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> during power on, if valid data was recovered from the D-Flash. </p>
<p>A power on is detected when two criteria are met:</p><ul>
<li>Data could not be recovered from <code>xdata</code> memory</li>
<li>Valid data was recovered from the D-Flash </li>
</ul>

</div>
</div>
<a id="a75a7f703f282c93c9080240c25368951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a7f703f282c93c9080240c25368951">&sect;&nbsp;</a></span>FLASH_PWR_RESET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_PWR_RESET&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returned by <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> after booting from a reset without power loss. </p>
<p>The typical mark of a reset is that <code>xdata</code> memory still holds data from the previous session. If such data is found it will just be picked up.</p>
<p>For performance reasons access to the struct is not guarded, which means that there can be no protection against data corruption, such as might be caused by a software bug like an overflow. </p>

</div>
</div>
<a id="a71bde424c23bd9ae815a892d241b1e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71bde424c23bd9ae815a892d241b1e45">&sect;&nbsp;</a></span>FLASH_STRUCT_FACTORY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_STRUCT_FACTORY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">members</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">This struct is a template for data that can be written to the D-Flash.</span></div><div class="line"><span class="comment">It is created by invoking the \ref FLASH_STRUCT_FACTORY macro.</span></div><div class="line"><span class="comment">         */</span>\</div><div class="line">        volatile <span class="keyword">struct </span>hsk_flash_struct {\<span class="comment"></span></div><div class="line"><span class="comment">                /**</span></div><div class="line"><span class="comment">For data integrity/compatibilty detection.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">@private</span></div><div class="line"><span class="comment">                 */</span>\</div><div class="line">                ubyte hsk_flash_prefix;\</div><div class="line">                \</div><div class="line">                members\</div><div class="line">                \<span class="comment"></span></div><div class="line"><span class="comment">                /**</span></div><div class="line"><span class="comment">For data integrity detection.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">@private</span></div><div class="line"><span class="comment">                 */</span>\</div><div class="line">                ubyte hsk_flash_chksum;\</div><div class="line">        } xdata</div></div><!-- fragment -->
<p>Used to create a struct that can be used with the <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> function. </p>
<p>The <a class="el" href="hsk__flash_8h.html#acc2074fa68d4da24fb483fbd49438da9" title="Recovers a struct from a previous session and sets everything up for storage of changes. ">hsk_flash_init()</a> function expects certain fields to exist, in the struct, which are used to ensure the consistency of data in the flash.</p>
<p>The following example shows how to create a struct named storableData: </p><div class="fragment"><div class="line"><a class="code" href="hsk__flash_8h.html#a71bde424c23bd9ae815a892d241b1e45">FLASH_STRUCT_FACTORY</a>(</div><div class="line">        ubyte storableByte;</div><div class="line">        uword storableWord;</div><div class="line">) storableData;</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">members</td><td>Struct member definitions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa6c4686de74233ed2950c20137c25948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6c4686de74233ed2950c20137c25948">&sect;&nbsp;</a></span>XC878_16FF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XC878_16FF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ensure that a flash memory layout is defined. </p>
<p>Either XC878_16FF (64k flash) or XC878_13FF(52k flash) are supported. XC878_16FF is the default. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acc2074fa68d4da24fb483fbd49438da9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc2074fa68d4da24fb483fbd49438da9">&sect;&nbsp;</a></span>hsk_flash_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ubyte hsk_flash_init </td>
          <td>(</td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uword&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ubyte&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recovers a struct from a previous session and sets everything up for storage of changes. </p>
<p>There are two modes of recovery. After a fresh boot the data can be recovered from flash, if previously stored there. After a simple reset the data can still be found in XRAM and recovery can be sped up.</p>
<p>If recovery fails entirely all members of the struct will be set to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">version</td><td>Version number of the persisted data structure, used to prevent initilization with incompatible data </td></tr>
    <tr><td class="paramname">ptr</td><td>A pointer to the xdata struct/array to persist </td></tr>
    <tr><td class="paramname">size</td><td>The size of the data structure to persist </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FLASH_PWR_FIRST</td><td>No valid data was recovered </td></tr>
    <tr><td class="paramname">FLASH_PWR_RESET</td><td>Continue operation after a reset </td></tr>
    <tr><td class="paramname">FLASH_PWR_ON</td><td>Data restore from the D-Flash succeeded </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a36a01af82333ae82b381cd939fcd421f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36a01af82333ae82b381cd939fcd421f">&sect;&nbsp;</a></span>hsk_flash_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool hsk_flash_write </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes the current data to the D-Flash. </p>
<p>Ongoing writes are interrupted. Ongoing deletes are interrupted unless there is insufficient space left to write the data.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>The D-Flash write is on the way </td></tr>
    <tr><td class="paramname">0</td><td>Not enough free D-Flash space to write, try again later </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c7ba009e8f625f49e696f17143a27bf0.html">hsk_flash</a></li><li class="navelem"><a class="el" href="hsk__flash_8h.html">hsk_flash.h</a></li>
    <li class="footer">Generated on Tue Jan 17 2017 00:45:18 for hsk-libs-user by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
