<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hsk-libs-dev: Coding Conventions and Guidelines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hsk-libs-dev
   &#160;<span id="projectnumber">270</span>
   </div>
   <div id="projectbrief">High Speed Karlsruhe XC878 library collection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Coding Conventions and Guidelines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section describes the coding style used in these libraries.</p>
<p>The term <em>member</em> in this section applies to functions, globals, structs, unions, typedefs and defines of the current library.</p>
<h1><a class="anchor" id="conventions_indent"></a>
Code/Comment Indention and Formatting</h1>
<p>Use 8 spaces wide real tabs for indention. Don't put spaces before a tab, even in comments, unless it is in a code or verbatim section.</p>
<p>In the following example tabs are symbolised by <code>&lt;tab&gt;</code> and the beginning of a line by <code>^</code>: </p><div class="fragment"><div class="line">^/**</div><div class="line">^ * Foobar struct.</div><div class="line">^ */</div><div class="line">^struct {</div><div class="line">^&lt;tab&gt;/**</div><div class="line">^&lt;tab&gt; * Lame text.</div><div class="line">^&lt;tab&gt; *</div><div class="line">^&lt;tab&gt; * Lame example:</div><div class="line">^&lt;tab&gt; * \code</div><div class="line">^&lt;tab&gt; * void foo() {</div><div class="line">^&lt;tab&gt; * &lt;tab&gt;doSomething();</div><div class="line">^&lt;tab&gt; * }</div><div class="line">^&lt;tab&gt; * \endcode</div><div class="line">^&lt;tab&gt; *</div><div class="line">^&lt;tab&gt; * @see</div><div class="line">^&lt;tab&gt; *&lt;tab&gt;Something else</div><div class="line">^&lt;tab&gt; */</div><div class="line">^&lt;tab&gt;ubyte member;</div><div class="line">^} foobar;</div></div><!-- fragment --><p> Formatting on the other hand should be done using spaces. This way, no matter the displayed tab width, formatted code and comments will always look as intended.</p>
<p>The values assigned to preprocessor defines should be aligned. The recommended indention is 4 spaces behind the longest identifier in the file. All other defines should be aligned to the same column.</p>
<p>In the next example <code>FOOBAR</code> is the longest identifier and thus dictates the formatting of all values: </p><div class="fragment"><div class="line">#define FOO       1</div><div class="line">#define BAR       2</div><div class="line">#define FOOBAR    3</div><div class="line">#define ZOOM      4</div></div><!-- fragment --><div class="image">
<img src="keil_configuration_Editor.png" alt="keil_configuration_Editor.png"/>
<div class="caption">
Keil µVision Editor tab of the configuration dialogue</div></div>
<h1><a class="anchor" id="conventions_comments"></a>
General Comment Guidlines</h1>
<p>Every member is to be documented in one of the following manners: </p><div class="fragment"><div class="line">/**</div><div class="line"> * &lt;brief&gt;</div><div class="line"> */</div><div class="line">&lt;member&gt;</div></div><!-- fragment --><div class="fragment"><div class="line">/**</div><div class="line"> * &lt;brief&gt;</div><div class="line"> *</div><div class="line"> * &lt;description&gt;</div><div class="line"> */</div><div class="line">&lt;member&gt;</div></div><!-- fragment --><ul>
<li><code>&lt;brief&gt;</code><ul>
<li>A short, single sentence description of the member</li>
</ul>
</li>
<li><code>&lt;description&gt;</code><ul>
<li>A detailed description of the member</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="conventions_comments_lists"></a>
List Formatting</h2>
<p>Descriptions may contain syntactical sugar such as lists: </p><pre class="fragment">This is a list:
- List entry 0
- List entry 1 is a little wider than 80 characters and thus needs to cover
  multiple lines
  - List entry 1.0
- List entry 2
</pre><p>List entries are started with a dash. Every sublevel is indented by 1 tab per level. In multiple line entries the successive lines are indented 2 additional spaces to align them with the previous line.</p>
<p>Unless it is a keyword the first word of a list entry needs to be a capital letter. List entries do not end with a full stop.</p>
<h2><a class="anchor" id="conventions_comments_tables"></a>
Tables</h2>
<p>The syntax for tables is: </p><pre class="fragment">| Heading 0    | Heading 1    |
|--------------|--------------|
| Row 0, col 0 | Row 0, col 1 |
| Row 1, col 0 | Row 1, col 1 |
</pre><p>The resulting table looks like this:</p>
<table class="doxtable">
<tr>
<th>Heading 0 </th><th>Heading 1  </th></tr>
<tr>
<td>Row 0, col 0 </td><td>Row 0, col 1 </td></tr>
<tr>
<td>Row 1, col 0 </td><td>Row 1, col 1 </td></tr>
</table>
<p>Use a colons in the seperator row to align columns: </p><pre class="fragment">| Heading Left | Heading Centre | Heading Right |
|:-------------|:--------------:|--------------:|
| Left         | Centre         | Right         |
</pre><table class="doxtable">
<tr>
<th align="left">Heading Left </th><th align="center">Heading Centre </th><th align="right">Heading Right  </th></tr>
<tr>
<td align="left">Left </td><td align="center">Centre </td><td align="right">Right </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>Take care to obey the <a class="el" href="conventions.html#conventions_indent">Code/Comment Indention and Formatting</a> guidelines, using the wrong tab width looks especially disturbing in the plain text version of a table.</dd></dl>
<h2><a class="anchor" id="conventions_comments_inline"></a>
Inline Comments</h2>
<p>Inline comments not intended to appear in the documentation can take one of the following shapes.<br />
Compact: </p><div class="fragment"><div class="line">/* &lt;comment&gt; */</div></div><!-- fragment --><p> Multiline compact: </p><div class="fragment"><div class="line">/* &lt;comment line 0&gt;</div><div class="line"> * &lt;comment line 1&gt; */</div></div><!-- fragment --><p> Significant: </p><div class="fragment"><div class="line">/*</div><div class="line"> * &lt;comment&gt;</div><div class="line"> */</div></div><!-- fragment --> <h1><a class="anchor" id="conventions_functions"></a>
Function Documentation</h1>
<p>Every parameter of a member function and the return value if present need JavaDoc style <code>@param</code> and <code>@return</code> documentations in their descriptions: </p><div class="fragment"><div class="line">/**</div><div class="line"> * &lt;brief&gt;</div><div class="line"> *</div><div class="line"> * &lt;description&gt;</div><div class="line"> *</div><div class="line"> * @param &lt;parameter&gt;</div><div class="line"> *      &lt;parameter description&gt;</div><div class="line"> * @return</div><div class="line"> *      &lt;return value description&gt;</div><div class="line"> */</div></div><!-- fragment --> <h2><a class="anchor" id="conventions_functions_return"></a>
Return Values</h2>
<p>Use <code>@retval</code> to document return values with logical instead of numerical meanings: </p><pre class="fragment">@retval 0
  The operation failed
@retval 1
  The operation succeeded
</pre><p>The resulting documentation takes the following appearance: </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The operation failed </td></tr>
    <tr><td class="paramname">1</td><td>The operation succeeded</td></tr>
  </table>
  </dd>
</dl>
<h2><a class="anchor" id="conventions_functions_scope"></a>
Public and Private Functions</h2>
<p>The documentation to public functions belongs into the <code>.h</code> file. All functions that have a prototype in the header file are considered public, private functions are those, which are only used internally in the <code>.c</code> file.</p>
<p>If a function is public additional documentation may be placed in the <code>.c</code> file, it will only show up in the developers' manual.</p>
<p>Inline comments within functions may appear in JavaDoc style, in that case they are also appended to the function documentation of the developers' manual.</p>
<p>Private functions should be marked with `` at the end of their documentation block.</p>
<h1><a class="anchor" id="conventions_groups"></a>
Grouping Documentation</h1>
<p>In some cases a set of documented members belong together, such as a set of defines for a certain function parameter. In such a cases the members can be grouped: </p><div class="fragment"><div class="line">/**</div><div class="line"> * \defgroup TRI_STATE Tri-State States</div><div class="line"> *</div><div class="line"> * Defines in this group represent one of the tri-state states</div><div class="line"> *</div><div class="line"> * @{</div><div class="line"> */</div><div class="line"></div><div class="line">/**</div><div class="line"> * Tri state off.</div><div class="line"> */</div><div class="line">#define TRI_STATE_OFF   0</div><div class="line"></div><div class="line">/**</div><div class="line"> * Tri state on.</div><div class="line"> */</div><div class="line">#define TRI_STATE_ON    1</div><div class="line"></div><div class="line">/**</div><div class="line"> * Tri state high impedance.</div><div class="line"> */</div><div class="line">#define TRI_STATE_Z     2</div><div class="line"></div><div class="line">/**</div><div class="line"> * @}</div><div class="line"> */</div></div><!-- fragment --><p> Groups are listed in the Modules chapter.</p>
<h1><a class="anchor" id="conventions_files"></a>
File Naming and Documentation</h1>
<p>Three different file type suffixes are used in the construction of these libraries, <code>.c</code> for C files, <code>.h</code> for header files and <code>.isr</code> for headers that only contain ISR prototypes.</p>
<p>The following naming conventions exist for each file: </p><pre class="fragment">hsk_&lt;category&gt;/hsk_&lt;name&gt;.&lt;suffix&gt;
</pre><ul>
<li><code>&lt;category&gt;</code><ul>
<li>The library category, often identical to name, but not necessarily so</li>
</ul>
</li>
<li><code>&lt;name&gt;</code><ul>
<li>The name of the library</li>
</ul>
</li>
<li><code>&lt;suffix&gt;</code><ul>
<li>The file type suffix</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="conventions_files_headers"></a>
Headers</h2>
<p>Be greedy. Only members, which are required to use a library should be listed in header files.</p>
<p>Header files in this project should avoid including other headers. There are two exceptions to that rule, headers containing a define to generate code might have to include headers for the generated code and headers. The second exception are <a class="el" href="conventions.html#conventions_files_isr">ISR Headers</a>.</p>
<p>Every header file begins with a JavaDoc style comment: </p><div class="fragment"><div class="line">/** \file</div><div class="line"> * HSK &lt;brief&gt; headers</div><div class="line"> *</div><div class="line"> * &lt;description&gt;</div><div class="line"> *</div><div class="line"> * @author &lt;author tag&gt;</div><div class="line"> */</div></div><!-- fragment --><ul>
<li><code>&lt;brief&gt;</code><ul>
<li>A descriptive title such as "Analog Digital Conversion" this description appears in the file list, nouns, verbs and adjectives in the brief should start with capital letters</li>
</ul>
</li>
<li><code>&lt;description&gt;</code><ul>
<li>A text containing all the necessary information to use the provided functions</li>
</ul>
</li>
<li><code>&lt;author tag&gt;</code><ul>
<li>A short author tag from <a class="el" href="authors.html">Authors</a></li>
</ul>
</li>
<li><code>&lt;iso date&gt;</code><ul>
<li>The ISO 8601 date (YYYY-MM-DD) of the last edit</li>
</ul>
</li>
</ul>
<p>The next block contains the traditional header opening: </p><div class="fragment"><div class="line">#ifndef _&lt;FILE&gt;_</div><div class="line">#define _&lt;FILE&gt;_</div></div><!-- fragment --><ul>
<li><code>&lt;FILE&gt;</code><ul>
<li>The file name with the following translation '[:lower:].' '[:upper:]_', e.g. <a class="el" href="hsk__isr_8h.html" title="HSK Shared Interrupt Service Routine headers. ">hsk_isr.h</a> becomes HSK_ISR_H</li>
</ul>
</li>
</ul>
<p>The <code>#ifndef</code> block is closed at the end of the header file with: </p><div class="fragment"><div class="line">#endif /* _&lt;FILE&gt;_ */</div></div><!-- fragment --><p> Prototypes etc. belong within the block.</p>
<h2><a class="anchor" id="conventions_files_c"></a>
C Files</h2>
<p>Like header files every C file starts with a JavaDoc style comment: </p><div class="fragment"><div class="line">/** \file</div><div class="line"> * HSK &lt;brief&gt; implementation</div><div class="line"> *</div><div class="line"> * &lt;description&gt;</div><div class="line"> *</div><div class="line"> * @author &lt;author tag&gt;</div><div class="line"> */</div></div><!-- fragment --><ul>
<li><code>&lt;brief&gt;</code><ul>
<li>Should be the same title as in the header file</li>
</ul>
</li>
<li><code>&lt;description&gt;</code><ul>
<li>Instead of how to use the library this should make mention of all things of interest, when working on the implementation</li>
</ul>
</li>
<li><code>&lt;author tag&gt;</code><ul>
<li>A short author tag from <a class="el" href="authors.html">Authors</a></li>
</ul>
</li>
</ul>
<p>The first include in a C file is the Infineon/XC878.h header, followed by the own header file. The next (optional) include block contains all the required C library headers. The final include block includes the headers of other libraries. The following example is from <a class="el" href="hsk__adc_8c.html" title="HSK Analog Digital Conversion implementation. ">hsk_adc.c</a>: </p><div class="fragment"><div class="line">#include &lt;Infineon/XC878.h&gt;</div><div class="line"></div><div class="line">#include &quot;hsk_adc.h&quot;</div><div class="line"></div><div class="line">#include &lt;string.h&gt; /* memset() */</div><div class="line"></div><div class="line">#include &quot;../hsk_isr/hsk_isr.h&quot;</div></div><!-- fragment --><p> Comments for public members of a C file do not need to be copied from the header.</p>
<h2><a class="anchor" id="conventions_files_isr"></a>
ISR Headers</h2>
<p>The ISR headers exist solely for an oddity of SDCC. All interrupts must be visible from the context of the <a class="el" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="Call init functions and invoke the run routine. ">main()</a> function.</p>
<p>Every implementation providing an interrupt has has to provide a .isr file. The file should just contain a very plain list of prototypes, the following examples is from hsk_timer01.isr: </p><div class="fragment"><div class="line">#ifndef _HSK_TIMER01_ISR_</div><div class="line">#define _HSK_TIMER01_ISR_</div><div class="line">void ISR_hsk_timer0(void) interrupt 1 using 1;</div><div class="line">void ISR_hsk_timer1(void) interrupt 3 using 1;</div><div class="line">#endif /* _HSK_TIMER01_ISR_ */</div><div class="line"></div></div><!-- fragment --><p>The <code>.isr</code> file should be included from the header file of the library providing it as well as from the header files of all libraries using that library.</p>
<p>The file should be included in the following manner: </p><div class="fragment"><div class="line">/*</div><div class="line"> * ISR prototypes for SDCC.</div><div class="line"> */</div><div class="line">#ifdef SDCC</div><div class="line">#include &quot;hsk_timer01.isr&quot;</div><div class="line">#endif /* SDCC */</div></div><!-- fragment --> <h1><a class="anchor" id="conventions_members"></a>
Member Naming Conventions</h1>
<p>All members except defines and statics have the same structure of context prefix. Contexts can be nested, each level of context is separated by an underscore. Member names following the underscore separated context are camel case. The root context is always the library, subcontexts need to have a central concept or data structure that defines them.</p>
<p>Defines are always specified in capitals. Thus all separation in the names of defines is done by underscore. Public defines have the library name without</p>
<p>Statics are considered private within the context and thus do not require a prefix.</p>
<p><code>HSK</code> as a prefix.</p>
<h2><a class="anchor" id="conventions_members_public"></a>
Public Example</h2>
<p>This subsection explains the naming conventions in public scope (i.e. in a header file) using the example of the hsk_can library. <p>Public defines are provided to interpret return values or to specify possible parameters: <div class="fragment"><div class="line">#define CAN_ERROR              0xff</div><div class="line">#define CAN0_IO_P10_P11        0</div><div class="line">#define CAN1_IO_P01_P02        4</div></div><!-- fragment --></p>
<p>Typedefs give primitive data types a meaningful name for use in a certain context. This library has functions that work on CAN nodes and functions that work on message objects: <div class="fragment"><div class="line">typedef ubyte hsk_can_node;</div><div class="line">typedef ubyte hsk_can_msg;</div></div><!-- fragment --></p>
<p>The CAN nodes are the central structure of the library. Functions in the <code>hsk_can</code> context always take a node as the first parameter: <div class="fragment"><div class="line">void hsk_can_init(const ubyte pins, const ulong __xdata baud);</div><div class="line">void hsk_can_enable(const hsk_can_node node);</div></div><!-- fragment --></p>
<p>Other functions work around the concepts of messages and message data, which are represented in their context prefixes: <div class="fragment"><div class="line">void hsk_can_msg_getData(const hsk_can_msg msg,</div><div class="line">                         ubyte * const msgdata);</div><div class="line">void hsk_can_data_setSignal(ubyte * const msg, const bool motorola,</div><div class="line">                            const bool sign, const ubyte bitPos,</div><div class="line">                            const char bitCount, const ulong idata value);</div></div><!-- fragment --></p>
<h2><a class="anchor" id="conventions_members_defines"></a>
Defines</h2>
<p>In the private context only a few rules apply to naming defines.</p>
<p>If defines are named after registers or bits from the µC manual, their original spelling should be preserved, even if it means including non-capital letters:  <div class="fragment"><div class="line">#define NBTRx                  0x0084</div></div><!-- fragment --></p>
<p>Apart from that special naming conventions for defines only apply to register bits. Every register bit definition is prefixed by <code>BIT</code>. Bit fields also specify a count: <div class="fragment"><div class="line">#define BIT_RXSEL              0</div><div class="line">#define CNT_RXSEL              3</div></div><!-- fragment --> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 20 2017 00:01:51 for hsk-libs-dev by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
